version: "3.8"
services:
  opensearch:
  image: opensearchproject/opensearch:2.10.2
  environment:
    - cluster.name=opensearch-cluster
    - discovery.type=single-node
    - "OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m"
    - plugins.security.disabled=true
  ulimits:
    memlock:
      soft: -1
      hard: -1
  volumes:
    - opensearch-data:/usr/share/opensearch/data
  ports:
    - "9200:9200"
    - "9600:9600"

opensearch-dashboards:
  image: opensearchproject/opensearch-dashboards:2.10.2
  ports:
    - "5601:5601"
  depends_on:
    - opensearch

backend:
  build: ./backend
  ports:
    - "8000:8000"
  environment:
    - OPENSEARCH_HOST=opensearch
    - OPENSEARCH_PORT=9200
    - SECRET_KEY=changemeverystrongsecret
  depends_on:
    - opensearch
  
volumes:
  opensearch-data: